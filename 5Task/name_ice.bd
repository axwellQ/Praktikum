import sqlite3

con = sqlite3.connect('db.sqlite')
cur = con.cursor()

results = cur.execute('''
    SELECT
        ic.title,
        c.slug,
        MAX(ic.price) AS price
    FROM ice_cream ic
    JOIN categories c ON ic.category_id = c.id
    GROUP BY ic.category_id
    ORDER BY ic.price DESC;
''')

for result in results:
    print(result)

con.close()
import sqlite3

con = sqlite3.connect('db.sqlite')
cur = con.cursor()

results = cur.execute('''
    SELECT
        ic.title,
        c.slug,
        w.title,
        MIN(ic.price) AS price,
        AVG(ic.price) AS avg_price
    FROM ice_cream ic
    JOIN categories c ON ic.category_id = c.id
    LEFT JOIN wrappers w ON ic.wrapper_id = w.id
    GROUP BY c.id
    ORDER BY ic.price DESC;
''')

for result in results:
    print(result)

con.close()